# The rapture and the reckoning

*I'm a believer—AI will change everything about data too.*

---

![the end is nigh | The End is Nigh sandwich board near the en… | Flickr](https://substackcdn.com/image/fetch/$s_!NAFf!,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F7b4b0b56-4c54-4017-86dc-b034c8799142_1024x687.jpeg)
*The mess-AI-ah is coming.*

Give me a Bible and a bullhorn; the end is near. 

All the work we’ve put in to building the modern data stack is on the cusp of being undone. Hard-won theologies will be proven wrong; [the day of judgment](https://www.biblegateway.com/passage/?search=Revelation+18%3A10&version=KJV) will come for our mighty Babylon. That great city will be thrown down; it will be cast into the sea, and dozens of promising SaaS tools [shall be found no more at all](https://www.biblegateway.com/passage/?search=Revelation+18%3A21&version=KJV).

The [prophets](https://www.wsj.com/articles/how-artificial-intelligence-will-change-everything-1488856320) were right. AI will change everything.

Admittedly, I didn’t believe them at first. Yes, large language models like ChatGPT are impressive, and image generation software like [Stable Diffusion](https://en.wikipedia.org/wiki/Stable_Diffusion) is breathtaking, but I never saw how this technology would meaningfully change the data industry. Most early converts would just point to ChatGPT, make a comment about how it can pass the bar exam, and handwave past how, exactly, this would change the day-to-day job of a data team. 

So far, its real applications have been either trivial or underwhelming. AI might help us identify defects in our data or anomalies in our metrics. Neat, I guess, but hardly transformational. It might [make us more creative analysts](https://twitter.com/bennstancil/status/1598522785453772800). Again, an improvement in degree, not in kind. 

What about [replacing analysts with a chatbot](https://www.patterns.app/blog/2023/01/18/crunchbot-sql-analyst-gpt/)? *That* would be a revolution—but we’re not anywhere close to it being possible. On the surface, early efforts like these to generate [SQL with ChatGPT](https://towardsdatascience.com/can-chatgpt-write-better-sql-than-a-data-analyst-f079518efab2) have been extraordinary. With shockingly little input and tuning, it can turn English questions into working queries. Though it’s only right about half the time—which isn’t close to good enough[^1]—that also means, when asked to perform a task that a tiny fraction of adults could do, it’s *right half the time.*

But these impressive demos are just that: Impressive demos. Though they aren’t exactly scripted, they’re run in tidy sandboxes that don’t resemble anything close to real data environments. The chatbot, for example, was built against a database [with three tables](https://www.patterns.app/blog/2023/01/18/crunchbot-sql-analyst-gpt/) and 32 columns. Everything was simply and sensibly named, mostly using words that can be looked up in a dictionary. The test questions were basic, unambiguous, and could be answered by an experienced analyst in a handful of lines of SQL.[^2]

The distance between this and companies’ actual data ecosystems is staggering. [In a webinar earlier this week](https://atlan.com/great-data-debate), Tristan Handy, the CEO of dbt Labs’, said that a meaningful percentage of their customers are using dbt to create more than 5,000 tables. These tables are often named with unintuitive and idiosyncratic idioms and abbreviations, and are littered with ambiguous words, like accounts and transactions, that mean different things in different contexts.[^3] There are no simple questions—answering “How many new European accounts did we add last week?” requires defining an account, what new means, where Europe is, when a week starts, [in what time zone it should be calculated in](https://twitter.com/teej_m/status/1616920472322727939), and if “add” means net or gross. And there aren’t often simple answers—the average query in Mode is 75 lines and 2,700 characters long. 

If ChatGPT is already unacceptably bad in [impossibly agreeable environments](https://twitter.com/sethrosen/status/1252291581320757249), it would be abysmal in the real world. To borrow again from Tristan in the same webinar, the early attempts to use AI to write SQL queries (to answer questions or to generate dbt models) are akin to our efforts to build self-driving cars. Practically overnight, both went from it being the stuff of science fiction to appearing tantalizing possible. But the [progress bar is a mirage](https://www.reddit.com/r/ProgrammerHumor/comments/s60to6/i_made_a_fake_progress_bar_to_shut_up_clients/). The edge cases—the construction sites, the unexpected traffic patterns, the school zones; the messy schemas, the bespoke metric definitions, the complex questions—are far, *far* harder than highways and dummy databases we got excited about. And I would guess that this is particularly true for using large language models to write company-specific queries. It’s hard enough to build a self-driving car that can navigate complicated neighborhoods; it’s quite another if every single one of those neighborhoods has its own traffic laws, follows different traditions, and has never bothered to write any of it down.[^4]

The inevitable revolution in data, it seems,  would arrive at the same time as our [autonomous cars](https://www.youtube.com/watch?v=Vrxyr1CjiSM):[^5] [Tomorrow](https://phys.org/news/2014-09-tesla-chief-self-driving-cars-corner.html). [Always](https://www.cnn.com/2019/02/20/tech/musk-self-driving-car-prediction/index.html) [tomorrow](https://www.dailymail.co.uk/sciencetech/article-11159627/Elon-Musk-claims-Teslas-fully-autonomous-self-driving-cars-available-end-2022.html).

# Where we're going, we don't need roads 

But maybe our problem is easier. Contemplating the problem of self-driving cars, Balaji Srinivasan—who may well be a chatbot himself, trained exclusively on backwater crypto subreddits, the University of Austin’s “[curriculum](https://www.uaustin.org/undergraduate-curriculum),” and *[Future](https://future.com/)*, Andreessen Horowitz’s techno-optimism content marketing program[^6]—proposed a solution: [Rebuild the roads](https://twitter.com/balajis/status/1578723247067389953).

Balaji’s tweet was ratioed into oblivion.[^7] Putting aside the fact we already have these roads—they're called train tracks—at our current pace of improving [two miles](https://www.google.com/maps/dir/37.773019,-122.4187079/37.804132,-122.42523/@37.7885145,-122.4394498,14z/data=!3m1!4b1!4m2!4m1!3e2) of road every [six years](https://www.sfmta.com/projects/van-ness-improvement-project), we’d be able to replace all [four million miles of roads](https://www.fhwa.dot.gov/policyinformation/pubs/hf/pl11028/chapter1.cfm) in the United States by the year 12,002,023.[^8]

Still, Balaji’s tweet highlights a useful trick. To solve a problem, we can solve it outright—or we can change the problem. Rather than asking self-driving cars to navigate hopelessly complex terrain, we could bulldoze the terrain into something more manageable. 

The same principle applies when we ask an AI to analyze today’s sprawling and labyrinthine data structures. We could demand it figure them out, or we could refactor them into something more consistent. And unlike our roads, these models are just code—they could be rebuilt, not in [meggannums](https://www.wikidata.org/wiki/Q20764), but in days and weeks. 

# Back to the future

Two decades ago, the data industry’s holy wars weren’t about meshes or contracts, but [warehouse schema design](https://andyhogg.files.wordpress.com/2012/11/kimball-vs-inmon.pdf). Should tables be wide or narrow? Should multiple tables [contain redundant information](https://www.geeksforgeeks.org/denormalization-in-databases/) to make queries faster by avoiding joins? How should [data marts](https://www.ibm.com/topics/data-mart) be used? These questions mattered because databases were much slower and more expensive back then. But an organized warehouse was a faster warehouse, so IT teams that rigorously chose and stuck to a consistent set of governing principles could squeeze out better performance. The only way to cook efficiently in a small kitchen is [by putting everything in its place](https://en.wikipedia.org/wiki/Mise_en_place); the only way to work with an old database is to be disciplined about how you structure your tables.

As warehouses have gotten faster, we’ve backed away from these principles. Part of that is intentional—ideas that were canon fifteen years ago [are now outdated](https://www.fivetran.com/blog/star-schema-vs-obt). Part of it is also probably necessary—the average Fivetran customer, for example, is extracting data from about 25 different services;[^9] it’s very difficult to apply a single design pattern across such a diverse range of sources. But most of our slow abandonment of old design principles feels like intellectual drift. Without yesterday’s performance constraints, we can lazily relax our standards. And more importantly, the accessibility of the modern data stack and tools like dbt make it possible for any [illiterate clown](https://twitter.com/bennstancil/status/1598518024490962952) to cosplay as a DBA. 

The results are predictably chaotic. Like most other [Kids These Days](https://www.tiktok.com/@lenovo/video/7136281311337123118),[^10] I don’t design our databases based on the actual teaching of Ralph Kimball or Bill Inman, but [in accordance with what I think their wishes might well have been](https://youtu.be/Wk61MeDmk2M?t=82). Fact and dimension tables aren’t oriented around tight star schemas; they’re instead just a naming convention for [separating tables of events from tables of objects](https://discourse.getdbt.com/t/how-we-structure-our-dbt-projects/355#:~:text=There%20are%20entire%20books%20written,customers%2C%20products%2C%20candidates%2C%20buildings%2C%20employees.). Most schemas aren’t intelligently designed; they’re emergent, the result of an evolving web of new models that are continually added to the dbt DAG. There is no law governing how the database should be organized; there’s convention and a bunch of halfway-educated best guesses. 

Amid this chaos, there have been some calls to [define schema design standards](https://www.getdbt.com/coalesce-2020/kimball-in-the-context-of-the-modern-data-warehouse-whats-worth-keeping-and-whats-not/) for the modern data stack. Of course, we shouldn’t try to go back to the same patterns we used a decade ago; we need new ones, for the people, data, and technology we have today. 

But why stop there? As messy as the current world is for us, it’s kryptonite for an AI. What if instead of building new patterns for people, we built them for our AI gods?

A few years ago, [Narrator](https://www.narratordata.com/), a product inspired by tools inside of WeWork, proposed a design pattern that they called the [activity schema](https://www.activityschema.com/). If nothing else, I give it points for audacity: The entire blueprint is one giant event table. It’s as if you took a star schema, joined every dimension table onto its corresponding fact table, and then unioned all of those fact tables together into one bottomless list of events.

Assuming this approach doesn’t have structural limitations (i.e., there aren’t questions that it can’t answer that other schemas could), its biggest problem might be usability. For analysts who are accustomed to thinking about relational models, working with [a single event stream and a bunch of self-joins](https://github.com/ActivitySchema/ActivitySchema/blob/main/2.0.md#multiple-activities) feels pretty unnatural. 

For ChatGPT, however, this could be trivially easy—far easier than stepping through a convoluted series of joins. Moreover, because the activity schema is heavily standardized, an LLM doesn’t need to be deeply aware of the individual idioms within each company that wants to use it. Train a general model with a bit more detail about activity schemas, prompt your version of it with the basic documentation of the events contained in your stream—in other words, put the car on the traffic-free interstate and tell it the traffic laws—and see how far *that'll* go.[^11]   

# Judgment day

To be clear, Narrator’s activity schema is meant to be illustrative, not prescriptive. I haven’t used it in meaningful ways, and I have no idea how ChatGPT would actually interact with it. The point, though, is that it seems unlikely that the schema design patterns that we created for people are optimized for LLMs. As the [skeptics of the chatbot analyst correctly pointed out](https://news.ycombinator.com/item?id=34521149), it’s the relational nuances that confuse AI models. But we could flip that. If AI-powered analytical tools have enough potential—which, seeing what ChatGPT can do, it seems like they do—would it not make sense to favor schema design patterns that enable the big-brained computers more than they enable us feeble-brained apes?

If something like this works, it’s a bomb that blows up half of the data industry. For data consumption, it would be like replacing [AOL channels](https://www.google.com/imgres?imgurl=https://newconsumer.com/wp-content/uploads/2021/02/aol-channels.jpg&imgrefurl=https://newconsumer.com/2021/02/clubhouse-mobile-audio-chat/&tbnid=jmZODA0oB8DLgM&vet=1&docid=YCdeJqhkVMjDrM&w=1400&h=879&source=sh/x/im) with search. Instead of leafing through a sitemap of existing reports, people could ask for what they need directly. Analysts would either become less relevant, or would finally be freed up to work on [more interesting things](https://benn.substack.com/p/why-do-people-want-to-be-analytics#footnote-anchor-3-62062026:~:text=A%20lot%20of%20analysts,on%20some%20real%20analysis.%E2%80%9D).[^12] 

Analytics engineering would be recast as well. Today, analytics engineers have to translate [complicated technical schemas](https://docs.google.com/presentation/d/1wSWI7SbY4NMtyRLWdg2Z4LW3-SRCF8K7McN0VzLjh3w/edit#slide=id.g1ba00f96b0c_2_0) into semantically useful ones that have to make sense to the people who use them. That’s an architectural job, it’s a creative job, and [it’s hard](https://twitter.com/tejasmanohar/status/1414670898880200712). Schema models designed for LLMs, by contrast, would probably come with a spec. Because the model wouldn’t need to be semantically expressive—LLMs find patterns, not meaning—that spec would likely also be relatively simple and consistent. Our transformation layers wouldn’t be inventive kitchens, figuring how to design bespoke dishes for individual customers. They’d instead become factories, stamping out the same standardized and machine-readable perforations that everyone else does. 

This would also make our data more reliable. Not only is something like the activity schema easier to produce than a complex logical mesh of tables and metrics; it would also be much easier to monitor and debug. Observability tools wouldn’t need to be anything more than an QA tester on an event stream assembly line. 

The implications of this would be profound. For decades, we’ve thought about building data tools and processes for people. They’ve been our best analysts, our best query writers, and our best decision makers. 

But I’m not so convinced that’s true anymore—and the only thing that’s keeping us on top is we’ve rigged the game in our favor. If that changes, if we design our worlds for AIs, [if we give our power and strength unto the beast](https://www.biblegateway.com/passage/?search=Revelation+17%3A13&version=KJV), we might be able to go much  further than we can today. A new heaven and a new earth will come, and the [first heaven and the first earth will pass away](https://www.biblegateway.com/passage/?search=Revelation+21%3A1&version=KJV). 


---


[^1]: Nobody’s going to use a tool that is randomly and confidently incorrect half the time, or even ten percent of the time. No CEO will send a financial statement to the board that misstates one in ten metrics wrong; no operations team will manage their inventory based on order volume reports that have a ten percent chance of being wrong. [Spectacularly bombing a mathematical riddle](https://twitter.com/Carnage4Life/status/1602802693034373120) is one thing; invisibly issuing a bad SEC filing is quite another.

[^2]: None of this is meant to be critical of either blog post, neither of which claim to be anything more than experiments.

[^3]: Are accounts…customers? People who signed up for a product? Shared workspaces for collections of users? The [Salesforce account object](https://help.salesforce.com/s/articleView?id=sf.accounts.htm&type=5)? The [Stripe account object](https://stripe.com/docs/api/accounts)? And transactions—are they customer orders? Credit card payments? Web events? The [Salesforce transaction object](https://help.salesforce.com/s/articleView?id=sf.om_order_transaction_objects.htm&language=en_US&r=https%3A%2F%2Fwww.google.com%2F&type=5)? The [Stripe transaction object](https://stripe.com/docs/api/issuing/transactions/object)?

[^4]: Some people drive on the right side of the road, some on the left, and lunatics [drive down the middle](https://mode.com/blog/should-sql-queries-use-trailing-or-leading-commas/#:~:text=nearly%2014%25%20of%20query%20authors%20in%20a%20disturbing%20middle%2C%20as%20tragic%20wafflers%2C%20acquiescent%20centrists%2C%20or%20intentional%20vandals%2C%20more%20anarchist%20than%20analyst.).

[^5]: [And our free beer.](https://happyneon.com/products/free-beer-tomorrow-neon-sign)

[^6]: I mean, [read this](https://balajis.com/elondrop/) and tell me it’s not at least *possible.*

[^7]: Balaji’s 9.1 quote-tweet-to-retweet ratio was higher* *than the 7.9 Matt Yglesias put up when *[well ackshually](https://twitter.com/mattyglesias/status/1529234787579355136)*’ed the Uvalde shooting, but far lower than the 51.3 [masterpiece](https://twitter.com/natesilver538/status/1478925497786675206) that Nate Silver dropped when he compared Covid school closures to the invasion of Iraq.

[^8]: True longtermism isn’t worried about our great-grandchildren, but about the world 400,000 generations hence, when the only surviving life is a few mountain lichens, a handful of [horseshoe crabs](https://en.wikipedia.org/wiki/Horseshoe_crab), and [Peter Thiel’s immortal husk](https://www.ft.com/content/681fa287-f9ff-47f3-9f44-c0736ee0ab53).

[^9]: In 2022, Fivetran said they were syncing data from [100,000 connectors](https://www.fivetran.com/press/fivetran-extends-market-leading-position-more-than-doubles-revenue-in-2021) for [4,000 customers](https://www.fivetran.com/blog/data-integration-gartner-mq).

[^10]: Ok, somehow Lenovo Tiktok [isn’t](https://www.tiktok.com/@lenovo/video/7193018093197724970) [bad](https://www.tiktok.com/@lenovo/video/7187496621737872682).

[^11]: Are there already two decades of history behind this idea? [Probably.](https://www.linkedin.com/feed/update/urn:li:activity:7024373260607713280/) But what is a data Substack if not a place to rebrand [old ideas](https://en.wikipedia.org/wiki/OLAP_cube) with [new names](https://benn.substack.com/p/metrics-layer)?

[^12]: Yes, there are already tools like Thoughtspot that sorta do this. The difference is that these tools either require a semantic model to work, or are tripped up by the same problems that confound today’s ChatGPT bots. The point here is to back up a step: Can we structure our data such that these tools work on complex questions without predefined semantic configurations?